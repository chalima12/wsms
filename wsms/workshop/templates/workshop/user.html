{% extends "./base1.html" %}


{% block title %}


<title>List of Users</title>

{% endblock title %}
{% block content %}







<section class='container-fluid'>
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
<div class="container mt-2"> 
<a class="btn btn-warning" href="register">


<span class="fa fa-plus">
&nbsp;&nbsp; Add User
</span>
</a>

<div class="container">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
        {% endif %}
</div> 


<div class="card">
<div class="card-header">
</h2 class="container mx-5 card-title">List of usres</h2>
</div>
<!-- /.card-header -->
<div class="card-body">
<table id="example1" class="table table-bordered table-striped">

<thead class="table-info-box">
<tr>
<th>Firstname</th>
<th>Lastname</th>
<th>Email</th>

{% if user.is_admin %}
  
<th>give role</th>
<th>Remove</th>
  
{% endif %}

</tr>
</thead>
<tbody>
{% for data in user_list %}



<td>{{data.first_name|upper}}</td>
<td>{{data.last_name|upper}}</td>
<td>{{data.user_name}} </td>

{% if user.is_admin %}
<td>
  <a class="btn btn-info btn-outline-light btn-sm" href="{% url 'workshop:assign_role' data.id %}">
    <span class="fa fa-aws">
    Assign Role
    </span>
    </a>
      



<td >
  <a style='border-radius:10%' class="btn btn-danger btn-sm" href="javascript:void(0)"
  data-toggle="modal"
  class="confirm-accept"
  data-url="{% url 'workshop:delete-user' data.id %}"
 
  data-target="#acceptItemModal"
  data-message="Are you Sure to delete {{data.first_name}}  ?">
  <i class="far fa-trash-alt"></i>
  <span>Delete</span></a>
 
 </td>
 </td> 
{% endif %}
  

   
 
</tr>



{% endfor %}
</tbody>
</table>
</div>
<!-- /.card-body -->
</div>
<!-- /.card -->


<!-- /.container-fluid -->
</section>
<div class="modal fade" id="modal-danger">
<div class="modal-dialog">
<div class="modal-content bg-danger">
<div class="modal-header">
<h4 class="modal-title">Warining</h4>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
</div>
<div class="modal-body">
<p>Do you want to delete this User&hellip;</p>
</div>
<div class="modal-footer justify-content-between">
<button type="button" class="btn btn-outline-light" data-dismiss="modal">Cancel</button>
<a class="btn btn-outline-light" href='#'>Delete</a>
</div>
</div>
<!-- /.modal-content -->
</div>
<!-- /.modal-dialog -->
</div>


{% block js %}
  <!-- Add this script at the end of your HTML file or in a separate JavaScript file -->
<script>
  // Use JavaScript to periodically check for the presence of the success message
  setInterval(function () {
      var successMessage = document.querySelector('.alert-success');

      if (successMessage) {
          // Update the navbar content here
          // You can use DOM manipulation or make an AJAX request to get updated data
          // For simplicity, let's assume the updated data is available in a JavaScript variable 'userData'
          updateNavbar(userData);

          // Remove the success message
          successMessage.remove();
      }
  }, 1000);  // Check every 1 second (adjust the interval as needed)

  function updateNavbar(userData) {
      // Update the navbar content based on the userData
      // Use DOM manipulation or any other method that suits your implementation
      // For example, you can update the user's name and profile picture
      document.querySelector('.profile-user-name').innerText = userData.user_name;

      if (userData.profile_picture_url) {
          document.querySelector('.profile-user-img').src = userData.profile_picture_url;
      }
  }
</script>

{% endblock js %}
  
{% endblock content %}


